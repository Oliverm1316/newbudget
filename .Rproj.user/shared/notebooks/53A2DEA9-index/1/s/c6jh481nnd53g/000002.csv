"0",""
"0","library(DT)"
"0","library(readxl)"
"0","library(lubridate)"
"0","library(dplyr)"
"0","library(chron)"
"0",""
"0","rooming <- read_excel(""rooming.xlsx"", sheet = ""rooming"", "
"0","           col_types = c(""text"", ""text"", ""text"", ""date"", ""date"",""text"",""text"",""text""))"
"0",""
"0","rooming <- rooming %>% arrange(last)"
"0","rooming$chkin <- ymd(rooming$chkin)"
"0","rooming$chkout <- ymd(rooming$chkout)"
"0","rooming$room_type <- factor(rooming$room_type)"
"0",""
"0","trnsfin <- read_excel(""rooming.xlsx"", sheet = ""trnsfin"","
"0","           col_types = c(""text"",""text"",""text"",""date"",""date"",""text""))"
"0",""
"0","trnsfin$arr_time <- times(format(trnsfin$arr_time,""%H:%M:%S""))"
"0","trnsfin$trnsf_in <- as.Date(trnsfin$trnsf_in) %>% format(""%Y-%m-%d"")"
"0",""
"0","trnsfout <- read_excel(""rooming.xlsx"", sheet = ""trnsfout"","
"0","           col_types = c(""text"",""text"",""text"",""date"",""date"",""text"",""date"",""text""))"
"0",""
"0","trnsfout$trnsfout_time <- times(format(trnsfout$trnsfout_time,""%H:%M:%S""))"
"0","trnsfout$pick_up <- times(format(trnsfout$pick_up,""%H:%M:%S""))"
"0","trnsfout$trnsf_out <- as.Date(trnsfout$trnsf_out) %>% format(""%Y-%m-%d"")"
"0",""
"0",""
"0","total <- merge(rooming,trnsfin, by = c(""first"",""last"",""country""), all = TRUE)"
"0","total_in_out <- merge(total,trnsfout, by = c(""first"",""last"",""country""),"
"0","                      all = TRUE)"
"0",""
"0","total_in_out_table <- total_in_out %>% arrange(last) %>% "
"0","  select(first,last,room_type,chkin,trnsf_in,chkout,trnsf_out)"
"0",""
"0","total_in_out_table$colors <- with(total_in_out_table, "
"0","  ifelse(trnsf_in >= chkin,""lightgreen"",""red""))"
"0",""
"0","datatable(total_in_out_table,"
"0","          options = list(pageLength = 100,"
"0","            columnDefs = list("
"0","              list("
"0","                visible = FALSE, targets = 8)))) %>% "
"0","              formatStyle(c(""trnsf_in"",""chkin""), `text-align` = 'center', valueColumns = ""colors"", backgroundColor = JS(""value""))"
